import numpy as np
import random
import math
import fractions
import matplotlib as mpl
import matplotlib.pyplot as plt
from matplotlib.colors import LinearSegmentedColormap
import matplotlib.animation as animation

num1 = [100694,99859,98729,97389,95997,94523,92692,90539,88481,86272,83697,80944,77790,74720,71307,67715,63981,60021,55929,51814,47473,43308,39178,35137,31080,27264,23729,20376,17239,14505,12068,9985,8181,6643,5377,4257,3392,2624,2076,1632,1291,1004,772,627,498,397,323,263,214,173,144,131,118,115,105,94,97,99,108,108,114,120,121,125,133,140,145,160,181,189,201,210,221,228,245,254,269,292,306,331,353,377,397,416,439,455,470,494,524,547,577,611,641,673,694,735,766,793,820,864,914,972,1021,1073,1104,1159,1201,1249,1290,1319,1373,1424,1496,1547,1623,1680,1738,1802,1849,1901,1962,2037,2135,2217,2303,2386,2456,2519,2602,2664,2731,2802,2935,3025,3159,3301,3388,3473,3575,3659,3761,3911,4032,4190,4342,4459,4562,4700,4805,4904,5040,5198,5364,5548,5725,5899,6070,6218,6357,6537,6656,6876,7075,7327,7534,7761,7984,8161,8317,8546,8728,8954,9200,9508,9806,10101,10388,10552,10779,11048,11287,11545,11871,12168,12507,12902,13214,13472,13771,14068,14380,14755,15121,15485,15976,16407,16791,17189,17522,17937,18367,18803,19216,19665,20203,20657,21181,21710,22077,22491,23052,23607,24266,24826,25393,25948,26613,27307,27858,28422,29074,29723,30375,31149,31718,32512,33306,34016,34642,35456,36114,36814,37615,38520,39344,40240,41205,41998,42901,43893,44745,45771,46722,47728,48700,49846,50984,51958,53039,54106,55293,56373,57538,58747,60052,61403,62724,64114,65485,66833,68181,69499,71049,72453,74008,75484,77108,78731,80458,82077,83570,85373,87197,88785,90681,92693,94666,96694,98525,100364,102267,104299,106313,108613,110865]
num2 = [100694,99718,98658,97240,95745,94123,92290,90145,88193,85786,83318,85392,87503,89526,91625,90137,88651,86869,84953,82855,80544,78223,75887,73419,70854,72683,74468,76355,78203,76083,73975,71910,69624,67366,65009,62578,60037,57313,54633,56293,57897,59635,61239,58977,56767,54529,52203,49931,47636,45259,42899,40362,37786,39134,40427,41786,42992,40977,38925,36947,34676,32537,30468,28485,26446,24466,22406,23240,24031,24901,25635,23754,22105,20355,18530,16858,15393,13753,12274,10841,9389,9877,10318,10804,11254,10040,8729,7465,6446,5477,4577,3830,3200,2657,2200,2333,2468,2634,2788,2323,1932,1613,1358,1139,972,855,784,747,721,769,828,863,910,887,870,865,864,894,920,952,1004,1043,1105,1151,1203,1264,1304,1374,1431,1499,1567,1651,1713,1793,1876,1943,2011,2075,2172,2265,2367,2445,2534,2674,2772,2860,2965,3050,3172,3298,3397,3519,3626,3771,3911,4026,4132,4246,4405,4491,4649,4791,4951,5114,5278,5408,5594,5697,5874,6035,6179,6345,6510,6717,6977,7237,7419,7652,7814,7956,8244,8425,8658,8907,9203,9418,9683,9910,10169,10383,10579,10840,11116,11364,11684,12019,12442,12744,13079,13366,13708,13939,14257,14601,15011,15434,15808,16212,16644,17049,17421,17826,18232,18673,19060,19565,20016,20604,21133,21677,22180,22619,23008,23451,24028,24622,25233,25898,26471,27129,27713,28345,28811,29406,30085,30834,31554,32260,33068,33771,34437,35106,35911,36647,37441,38236,39247,40154,41180,42032,42990,43863,44833,45731,46759,47694,48799,49963,51220,52386,53517,54659,55649,56782,57989,59215,60353,61590,62938,64424,65788,67201,68624,70056,71402,72814,74325,75744,77258,79034,80628,82512,84062,85742,87559,89428,91151,92869,94944,96866,98893,100864,102833,105168,107442,109542,111785]

num3 = [100694,99736,98556,97057,95691,93865,92076,89830,87528,85182,82303,84527,86624,88755,90797,92944,95017,97201,99228,98286,97115,95679,94210,92530,90619,88658,86574,84400,81951,84113,86267,88485,90452,92386,94334,96211,98235,97445,96161,94753,93138,91381,89538,87605,85395,83228,80648,82632,84649,86667,88747,90851,92764,94880,96908,95928,94605,93107,91582,89929,87997,86173,83911,81510,78845,80898,82843,84665,86517,88625,90611,92337,94360,93470,92128,90702,89070,87148,85280,83436,81367,79180,76630,78447,80423,82543,84620,86356,88122,90208,92079,91315,90097,88659,87128,85664,83931,81987,79698,77436,74760,76634,78622,80561,82547,84535,86482,88425,90135,89125,87902,86550,85078,83535,81706,79883,77986,75618,73183,74799,76790,78673,80596,82419,84136,86009,88024,87194,86115,84819,83394,81700,80026,78317,76134,73997,71636,73509,75325,77187,78963,80832,82324,84173,85909,84842,83615,82199,80924,79246,77328,75432,73116,70672,68245,70216,71985,73851,75755,77491,79236,80987,82634,81623,80562,79425,77976,76511,74958,73051,71317,69386,67366,69055,70771,72456,74135,75837,77521,79090,80846,79810,78645,77393,76107,74628,72779,70934,69047,66977,64666,66481,68240,70059,71683,73193,74788,76302,77912,76878,75928,74912,73671,72292,70689,69018,67163,65112,63044,64813,66541,68163,69729,71300,72831,74401,76072,75329,74149,73046,71849,70576,69208,67584,66064,64293,62552,64149,65628,67146,68603,70289,71783,73385,74991,74297,73512,72510,71318,69892,68456,67036,65305,63457,61560,63240,64724,66370,67984,69537,71150,72615,74102,73424,72552,71561,70325,69090,67754,66112,64540,62881,61054,62555,64119,65757,67500,69099,70714,72226,73709,73070,72157,71104,70004,68787,67632,66193,64741,63215,61436,63128,64664,66196,67768,69279,70828,72345,73944,73410,72853,71994,71145,69964,68931,67705,66412,64833,63223,64881,66427,67868,69508,71094,72643,74217,75844,75259,74502,73851,73106,72194,71064,69833,68813,67497,66052,67791,69500,71013,72579,74248,75850,77503,79080,78991,78789,78238,77646,77112,76187,75322,74424,73498,72693,74466,76247,77897,79579,81258,82875,84516,86424,86451,86291,86130,85585,85228,84807,84417,83797,83150,82358,84422,86315,88172,90010,91893,93744,95813,97705,97800,97946,98002,98068,98060,97964,97803,97614,97497,97283,99438,101605,103609,105723,107937,110198]

t1list = range(0, len(num1), 1)
t2list = range(0, len(num2), 1)
t3list = range(0, len(num3), 1)

fig = plt.figure(figsize=(10, 2))
ax1 = fig.add_subplot(1, 1, 1)

ax1.set_xlim([0, 400])
tick = range(0, 400, 50)
plt.xticks(tick)
ax1.set_yscale('log')
ax1.set_ylim([1,1000000])

plt.xlabel("Time")
plt.ylabel("Number of cells")

ax1.plot(t1list, num1, label="schedule①", color="#F8766D")
ax1.plot(t2list, num2, label="schedule②", color="#22BC42")
ax1.plot(t3list, num3, label="schedule③", color="#619CFF")

ax1.set_title('Comparison of the dosing schedule')
ax1.legend(loc='lower right')
plt.plot([50, 50],[0, 1000000],"black", linestyle='dashed')
plt.plot([100, 100],[0, 1000000],"black", linestyle='dashed')
plt.plot([150, 150],[0, 1000000],"black", linestyle='dashed')
plt.plot([200, 200],[0, 1000000],"black", linestyle='dashed')
plt.plot([250, 250],[0, 1000000],"black", linestyle='dashed')

plt.plot([len(num1), len(num1)],[0, 1000000],"black", linestyle='dashed')
plt.plot([len(num2), len(num2)],[0, 1000000],"black", linestyle='dashed')
plt.plot([len(num3), len(num3)],[0, 1000000],"black", linestyle='dashed')

pidpng = "../result/pngstore/wayyo.png"
plt.show()
