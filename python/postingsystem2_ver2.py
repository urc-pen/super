import numpy as np
import random
import math
import fractions
import matplotlib as mpl
import matplotlib.pyplot as plt
from matplotlib.colors import LinearSegmentedColormap
import matplotlib.animation as animation

interval = 8

num1 = [99822,98517,97096,95479,93818,91944,89646,87560,84931,82258,84482,86432,88459,90684,92620,94779,96846,98844,97857,96842,95542,94010,92188,90284,88537,86168,83632,80961,83008,85187,87275,89358,91286,93185,95316,97129,96122,94956,93619,92013,90274,88405,86446,84330,81977,79426,81524,83623,85682,87629,89578,91424,93225,95107,94150,92821,91275,90077,88592,86827,84929,82676,80399,78083,80005,82016,83919,85998,88116,90138,92097,93898,92868,91637,90250,88715,87060,85416,83516,81479,79147,76716,78694,80640,82424,84391,86385,88322,90414,92295,91495,90135,88852,87270,85639,83819,81879,79796,77567,75367,77305,79278,81082,82829,84714,86583,88382,90413,89570,88533,87164,85614,83949,82262,80150,78009,75691,73195,75115,76975,79000,80913,82766,84593,86305,88111,87174,85951,84635,83313,81502,79832,77926,75852,73557,71119,73122,75005,76847,78620,80395,82198,83868,85703,84826,83629,82387,81057,79496,77657,75958,74136,71949,69692,71519,73420,75235,77144,78870,80544,82173,84004,83178,82133,80965,79572,78031,76450,74732,72873,70779,68540,70234,71979,73810,75510,77413,79188,80867,82727,81793,80882,79581,78138,76643,74906,73158,71058,68914,66700,68492,70201,71869,73585,75505,77146,78730,80391,79514,78358,77078,75736,74159,72525,70800,68904,66724,64430,66108,67769,69523,71136,72641,74235,75958,77650,76871,75852,74674,73394,71912,70249,68478,66566,64395,62139,63864,65581,67140,68755,70205,71858,73476,75045,74340,73316,72232,70910,69581,68108,66392,64616,62623,60686,62228,63831,65516,67076,68695,70331,71763,73190,72336,71472,70371,69230,67842,66380,64913,63272,61357,59347,60840,62347,63872,65436,66964,68460,69847,71401,70664,69679,68770,67740,66349,64976,63518,62057,60451,58623,60114,61664,63136,64559,65957,67398,68844,70288,69499,68764,67688,66443,65088,63765,62321,60775,59127,57295,58692,60279,61828,63217,64596,66040,67259,68625,67860,66973,66125,64915,63687,62420,60999,59556,58001,56291,57677,59165,60626,61923,63306,64692,66133,67557,66918,66066,65138,64200,63281,62236,61105,59912,58684,57291,58534,59906,61279,62552,64105,65476,66782,68173,67632,66757,65979,65181,64318,63412,62316,61116,60064,58908,60365,61652,62930,64191,65457,66682,68027,69470,68867,68042,67317]

num2 = [8,8,7,7,8,8,7,7,7,7,7,7,6,6,7,8,7,8,7,7,6,6,6,6,7,6,7,8,8,8,8,8,7,8,7,8,8,9,10,10,10,10,9,10,11,12,13,13,14,12,13,12,12,13,13,14,14,15,15,16,14,15,15,15,15,16,16,18,20,22,23,23,22,23,20,23,25,25,23,24,26,23,23,24,26,24,24,24,22,23,23,26,26,26,27,28,29,28,29,29,29,32,34,37,40,42,40,39,39,40,38,42,46,47,50,51,50,48,49,48,51,55,59,60,64,63,63,66,65,62,65,68,69,74,81,86,89,85,88,90,94,95,100,100,101,105,105,110,110,111,111,113,118,124,133,136,138,146,150,150,155,166,170,186,187,187,189,199,204,205,219,231,233,240,251,261,274,288,291,306,318,328,337,345,360,376,401,414,426,439,466,494,510,531,560,575,591,610,637,661,686,713,741,772,805,828,856,877,910,952,991,1043,1061,1095,1135,1178,1211,1235,1271,1315,1362,1394,1457,1483,1517,1568,1613,1675,1726,1784,1861,1923,1975,2029,2061,2113,2161,2201,2278,2352,2461,2537,2619,2660,2713,2770,2840,2913,2997,3100,3200,3296,3389,3489,3560,3643,3730,3797,3901,4025,4164,4269,4363,4493,4589,4678,4791,4924,5048,5204,5332,5508,5673,5788,5921,6042,6198,6339,6476,6627,6765,6975,7211,7361,7517,7686,7858,8012,8235,8427,8629,8849,9143,9341,9546,9810,10018,10247,10504,10764,11028,11307,11623,11935,12153,12448,12667,12916,13216,13457,13762,14081,14502,14924,15308,15623,15965,16387,16700,16980,17357,17735,18191,18663,19056,19467,19909,20356,20784,21274,21730,22187,22699,23221,23767,24204,24798,25296,25800,26426,27027,27606,28177,28769,29321,29980,30628,31270,31953,32665,33410,34090,34789,35555,36313,37061,37859,38629,39369,40222,41077,41815,42826]
t1list = range(0, len(num1), 1)
t2list = range(0, len(num2), 1)

fig = plt.figure(figsize=(10, 2))
ax1 = fig.add_subplot(1, 1, 1)

ax1.set_xlim([0, 400])
tick = range(0, 400, 50)
plt.xticks(tick)
ax1.set_yscale('log')
ax1.set_ylim([1,1000000])
tick2 = range(0, 2, 1)

ax1.set_xlabel("Time")
ax1.set_ylabel("Number of cells")

ax1.plot(t1list, num1, label="no drug-resistant", color=(0.2, 0.8, 1))
ax1.plot(t2list, num2, label="drug-resistatnt", color=(0.8, 0.1, 0.2))
time = 0
limit = max([len(num1), len(num2)])

ax1.plot([50, 50],[0, 1000000],"black", linestyle='dashed')
ax1.plot([100, 100],[0, 1000000],"black", linestyle='dashed')
ax1.plot([150, 150],[0, 1000000],"black", linestyle='dashed')
ax1.plot([200, 200],[0, 1000000],"black", linestyle='dashed')
ax1.plot([250, 250],[0, 1000000],"black", linestyle='dashed')

ax1.plot([len(num1), len(num1)],[0, 1000000],"black", linestyle='dashed')
ax1.plot([len(num2), len(num2)],[0, 1000000],"black", linestyle='dashed')

plt.axvspan(0, 10,alpha=1.0,color="#D5D5D5", label="time of dosing")

if interval == 0:
    plt.axvspan(10, limit,alpha=1.0,color="#D5D5D5")
    ax1.set_title('schedule①')

if interval == 4:
    time = 14
    ax1.set_title('schedule②')
    while time + 10 < limit:
        plt.axvspan(time, time + 10,alpha=1.0,color="#D5D5D5")
        time += 14
    if time <= limit < time + 10:
        plt.axvspan(time, limit,alpha=1.0,color="#D5D5D5")

if interval == 8:
    ax1.plot([250, 250],[0, 1000000],"black", linestyle='dashed')
    time = 18
    ax1.set_title('schedule③')
    while time + 10 < limit:
        plt.axvspan(time, time + 10,alpha=1.0,color="#D5D5D5")
        time += 18
    if time <= limit < time + 10:
        plt.axvspan(time, limit,alpha=1.0,color="#D5D5D5")

pidpng = "../result/pngstore/wayyo.png"
plt.show()
