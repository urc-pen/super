import numpy as np
import random
import math
import fractions
import matplotlib as mpl
import matplotlib.pyplot as plt
from matplotlib.colors import LinearSegmentedColormap
import matplotlib.animation as animation

num1 = [100694,99859,98729,97389,95997,94523,92692,90539,88481,86272,83697,80944,77790,74720,71307,67715,63981,60021,55929,51814,47473,43308,39178,35137,31080,27264,23729,20376,17239,14505,12068,9985,8181,6643,5377,4257,3392,2624,2076,1632,1291,1004,772,627,498,397,323,263,214,173,144,131,118,115,105,94,97,99,108,108,114,120,121,125,133,140,145,160,181,189,201,210,221,228,245,254,269,292,306,331,353,377,397,416,439,455,470,494,524,547,577,611,641,673,694,735,766,793,820,864,914,972,1021,1073,1104,1159,1201,1249,1290,1319,1373,1424,1496,1547,1623,1680,1738,1802,1849,1901,1962,2037,2135,2217,2303,2386,2456,2519,2602,2664,2731,2802,2935,3025,3159,3301,3388,3473,3575,3659,3761,3911,4032,4190,4342,4459,4562,4700,4805,4904,5040,5198,5364,5548,5725,5899,6070,6218,6357,6537,6656,6876,7075,7327,7534,7761,7984,8161,8317,8546,8728,8954,9200,9508,9806,10101,10388,10552,10779,11048,11287,11545,11871,12168,12507,12902,13214,13472,13771,14068,14380,14755,15121,15485,15976,16407,16791,17189,17522,17937,18367,18803,19216,19665,20203,20657,21181,21710,22077,22491,23052,23607,24266,24826,25393,25948,26613,27307,27858,28422,29074,29723,30375,31149,31718,32512,33306,34016,34642,35456,36114,36814,37615,38520,39344,40240,41205,41998,42901,43893,44745,45771,46722,47728,48700,49846,50984,51958,53039,54106,55293,56373,57538,58747,60052,61403,62724,64114,65485,66833,68181,69499,71049,72453,74008,75484,77108,78731,80458,82077,83570,85373,87197,88785,90681,92693,94666,96694,98525,100364,102267,104299,106313,108613,110865]
num2 = [100694,99718,98658,97240,95745,94123,92290,90145,88193,85786,83318,85392,87503,89526,91625,90137,88651,86869,84953,82855,80544,78223,75887,73419,70854,72683,74468,76355,78203,76083,73975,71910,69624,67366,65009,62578,60037,57313,54633,56293,57897,59635,61239,58977,56767,54529,52203,49931,47636,45259,42899,40362,37786,39134,40427,41786,42992,40977,38925,36947,34676,32537,30468,28485,26446,24466,22406,23240,24031,24901,25635,23754,22105,20355,18530,16858,15393,13753,12274,10841,9389,9877,10318,10804,11254,10040,8729,7465,6446,5477,4577,3830,3200,2657,2200,2333,2468,2634,2788,2323,1932,1613,1358,1139,972,855,784,747,721,769,828,863,910,887,870,865,864,894,920,952,1004,1043,1105,1151,1203,1264,1304,1374,1431,1499,1567,1651,1713,1793,1876,1943,2011,2075,2172,2265,2367,2445,2534,2674,2772,2860,2965,3050,3172,3298,3397,3519,3626,3771,3911,4026,4132,4246,4405,4491,4649,4791,4951,5114,5278,5408,5594,5697,5874,6035,6179,6345,6510,6717,6977,7237,7419,7652,7814,7956,8244,8425,8658,8907,9203,9418,9683,9910,10169,10383,10579,10840,11116,11364,11684,12019,12442,12744,13079,13366,13708,13939,14257,14601,15011,15434,15808,16212,16644,17049,17421,17826,18232,18673,19060,19565,20016,20604,21133,21677,22180,22619,23008,23451,24028,24622,25233,25898,26471,27129,27713,28345,28811,29406,30085,30834,31554,32260,33068,33771,34437,35106,35911,36647,37441,38236,39247,40154,41180,42032,42990,43863,44833,45731,46759,47694,48799,49963,51220,52386,53517,54659,55649,56782,57989,59215,60353,61590,62938,64424,65788,67201,68624,70056,71402,72814,74325,75744,77258,79034,80628,82512,84062,85742,87559,89428,91151,92869,94944,96866,98893,100864,102833,105168,107442,109542,111785]

t1list = range(0, len(num1), 1)
t2list = range(0, len(num2), 1)

fig = plt.figure(figsize=(10, 2))
fig2 = plt.figure(figsize=(10, 1))
ax1 = fig.add_subplot(1, 1, 1)
ax2 = fig2.add_subplot(1, 1, 1)

ax1.set_xlim([0, 400])
ax2.set_xlim([0, 400])
tick = range(0, 400, 50)
plt.xticks(tick)
ax1.set_yscale('log')
ax1.set_ylim([1,1000000])
tick2 = range(0, 2, 1)
ax2.set_ylim([0,2])
ax2.tick_params(labelleft=False)
ax2.set_yticks(tick2)

ax2.set_xlabel("Time")
ax1.set_ylabel("Number of cells")
ax2.set_ylabel("Dosing")

ax1.plot(t1list, num1, label="no drug-resistant", color=(0.2, 0.8, 1))
ax1.plot(t2list, num2, label="drug-resistatnt", color=(0.8, 0.1, 0.2))
time = 0
limit = max([len(num1), len(num2)])
while time + 10 < limit:
    ax2.plot([time, time + 10], [1, 1],color="#F8766D")
    time += 14
if time <= limit < time + 10:
    ax2.plot([time, limit], [1, 1],color="#F8766D")


ax1.set_title('scheduleâ‘ ')

ax1.plot([50, 50],[0, 1000000],"black", linestyle='dashed')
ax1.plot([100, 100],[0, 1000000],"black", linestyle='dashed')
ax1.plot([150, 150],[0, 1000000],"black", linestyle='dashed')
ax1.plot([200, 200],[0, 1000000],"black", linestyle='dashed')
ax1.plot([250, 250],[0, 1000000],"black", linestyle='dashed')

ax1.plot([len(num1), len(num1)],[0, 1000000],"black", linestyle='dashed')
ax1.plot([len(num2), len(num2)],[0, 1000000],"black", linestyle='dashed')

pidpng = "../result/pngstore/wayyo.png"
plt.show()
